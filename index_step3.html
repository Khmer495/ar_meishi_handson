<!DOCTYPE HTML>
<html>

<head>
  <script src='https://aframe.io/releases/0.9.2/aframe.min.js'></script>
  <script src='https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js'></script>
</head>

<body style='margin: 0px; overflow: hidden;'>

  <script>
    /*
    let initAnimation = function(pokemon) {
      AFRAME.registerComponent(`marker_${pokemon}`, {
        init: function () {
          let marker = this.el;
          marker.addEventListener('markerFound', function () {
            document.getElementById(`ent_${pokemon}`).setAttribute('animation__init', 'enabled: true');
          });
        }
      });
    }
    initAnimation('hitokage');
    initAnimation('zenigame');
    initAnimation('husigidane');
    */
  </script>

  <a-scene embedded arjs='debugUIEnabled: false; patternRatio: 0.9;' renderer='colorManagement: true;'>
    <a-assets>
      <a-asset-item id='glb_hitokage' src='./step3/hitokage.glb'></a-asset-item>
      <a-asset-item id='glb_zenigame' src='./step3/zenigame.glb'></a-asset-item>
      <a-asset-item id='glb_husigidane' src='./step3/husigidane.glb'></a-asset-item>
      <a-asset-item id='glb_metamon' src='./step3/metamon.glb'></a-asset-item>
    </a-assets>

    <a-marker preset='custom' type='pattern' url='./step3/pattern-hitokage.patt' marker_hitokage>
      <a-entity rotation='-90 0 0'>
        <a-entity id='ent_hitokage' gltf-model='#glb_hitokage' scale='0 0 0' rotation='0 0 0'
          animation__init='property: scale; dur: 1; enabled: true;'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: animationcomplete__init, start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
        <a-entity id='ent_hitokage_metamon' gltf-model='#glb_metamon' scale='0 0 0' rotation='0 0 0'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
      </a-entity>
    </a-marker>

    <a-marker preset='custom' type='pattern' url='./step3/pattern-zenigame.patt' marker_zenigame>
      <a-entity rotation='-90 0 0'>
        <a-entity id='ent_zenigame' gltf-model='#glb_zenigame' scale='0 0 0' rotation='0 0 0'
          animation__init='property: scale; dur: 1; enabled: false;'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: animationcomplete__init, start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
        <a-entity id='ent_zenigame_metamon' gltf-model='#glb_metamon' scale='0 0 0' rotation='0 0 0'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
      </a-entity>
    </a-marker>

    <a-marker preset='custom' type='pattern' url='./step3/pattern-husigidane.patt' marker_husigidane>
      <a-entity rotation='-90 0 0'>
        <a-entity id='ent_husigidane' gltf-model='#glb_husigidane' scale='0 0 0' rotation='0 0 0'
          animation__init='property: scale; dur: 1; enabled: false;'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: animationcomplete__init, start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
        <a-entity id='ent_husigidane_metamon' gltf-model='#glb_metamon' scale='0 0 0' rotation='0 0 0'
          animation__scale_in='property: scale; dur: 2000; from: 0 0 0; to: 1 1 1; easing: linear; startEvents: start;'
          animation__rotation='property: rotation; dur: 4000; from: 0 0 0; to: 0 360 0; easing: linear; loop: true; startEvents: animationcomplete__scale_in; pauseEvents: animationcomplete__scale_out;'
          animation__scale_out='property: scale; dur: 2000; from: 1 1 1; to: 0 0 0; easing: linear; startEvents: click;'
        ></a-entity>
      </a-entity>
    </a-marker>

    <a-entity camera>
      <a-entity cursor='fuse: false; rayOrigin: mouse'></a-entity>
    </a-entity>
  </a-scene>

  <script>
    let changePokemon = function(pokemon) {
      let metamon = document.getElementById(`ent_${pokemon}_metamon`)
      let trans = document.getElementById(`ent_${pokemon}`);
      trans.addEventListener('animationcomplete__scale_out', function () {
        trans.setAttribute('rotation', '0 0 0');
        metamon.emit('start');
      });
      metamon.addEventListener('animationcomplete__scale_out', function () {
        metamon.setAttribute('rotation', '0 0 0');
        trans.emit('start');
      });
    }
    changePokemon('hitokage');
    changePokemon('zenigame');
    changePokemon('husigidane');
  </script>
</body>

</html>

